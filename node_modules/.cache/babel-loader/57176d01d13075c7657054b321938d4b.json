{"ast":null,"code":"import _defineProperty from \"/Users/tweecezor/Desktop/nodeJS/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/tweecezor/Desktop/nodeJS/src/components/AdminPanel/AdminPanel.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport _cloneDeep from 'lodash/cloneDeep';\nimport { isLoadingUsersSelector, usersSelector, getUsers, updateUserPermission, deleteUser } from '../../store/adminPanel';\nimport { Container, Avatar, Grid, Paper, Button, ButtonGroup, Select, FormControl, MenuItem, InputLabel } from '@material-ui/core';\nimport { withStyles } from '@material-ui/styles';\nimport SettingsFormGroup from './AdminPanelSettingsFormGroup';\n\nconst styles = theme => ({\n  wrapper: {\n    width: '100%',\n    flex: '1 1 100%',\n    paddingTop: '40px'\n  },\n  formCard: {\n    padding: theme.spacing(2)\n  },\n  userSelect: {\n    width: '100%'\n  },\n  userAvatar: {\n    marginRight: theme.spacing(2)\n  },\n  mb3: {\n    marginBottom: theme.spacing(3)\n  }\n});\n\nconst defaultState = {\n  selectedUserId: '',\n  selectedUser: null,\n  permission: {\n    chat: {\n      C: true,\n      R: true,\n      U: false,\n      D: false\n    },\n    news: {\n      C: true,\n      R: true,\n      U: false,\n      D: false\n    },\n    settings: {\n      C: true,\n      R: true,\n      U: false,\n      D: false\n    }\n  }\n};\n\nclass AdminPanel extends PureComponent {\n  constructor(...args) {\n    super(...args);\n    this.state = defaultState;\n\n    this.handleChange = part => partRule => event => {\n      const checked = event.target.checked;\n      const permission = this.state.permission;\n      this.setState({\n        permission: _objectSpread({}, permission, {\n          [part]: _objectSpread({}, permission[part], {\n            [partRule]: checked\n          })\n        })\n      });\n    };\n\n    this.handleChangeUser = event => {\n      const users = this.props.users;\n      const value = event.target.value;\n      const selectedUser = value ? _cloneDeep(users.find(u => u.id === value)) : null;\n      this.setState({\n        selectedUserId: value,\n        selectedUser,\n        permission: selectedUser.permission\n      });\n    };\n\n    this.submitHandler = () => {\n      const _this$state = this.state,\n            permission = _this$state.permission,\n            selectedUserId = _this$state.selectedUserId;\n      const dispatch = this.props.dispatch;\n      dispatch(updateUserPermission(selectedUserId, permission));\n    };\n\n    this.cancelHandler = () => {\n      const users = this.props.users;\n      const selectedUserId = this.state.selectedUserId;\n\n      const selectedUser = _cloneDeep(users.find(u => u.id === selectedUserId));\n\n      selectedUserId && this.setState({\n        selectedUser,\n        permission: selectedUser.permission\n      });\n    };\n\n    this.deleteHandler = () => {\n      const selectedUserId = this.state.selectedUserId;\n      const dispatch = this.props.dispatch;\n      selectedUserId && dispatch(deleteUser(selectedUserId)).then(() => this.setState(defaultState));\n    };\n  }\n\n  componentDidMount() {\n    const dispatch = this.props.dispatch;\n    dispatch(getUsers());\n  }\n\n  render() {\n    const _this$props = this.props,\n          classes = _this$props.classes,\n          users = _this$props.users;\n    const _this$state2 = this.state,\n          selectedUserId = _this$state2.selectedUserId,\n          selectedUser = _this$state2.selectedUser;\n    return React.createElement(\"div\", {\n      className: classes.wrapper,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(Paper, {\n      className: classes.formCard,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      wrap: \"nowrap\",\n      alignItems: \"center\",\n      className: classes.mb3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(Avatar, {\n      src: selectedUser && selectedUser.image || '/assets/img/no-user-image.png',\n      className: classes.userAvatar,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }), React.createElement(FormControl, {\n      className: classes.userSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(InputLabel, {\n      htmlFor: \"age-simple\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"), React.createElement(Select, {\n      value: selectedUserId,\n      onChange: this.handleChangeUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(MenuItem, {\n      value: null,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"\\u041D\\u0435 \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\"), users.map(user => React.createElement(MenuItem, {\n      value: user.id,\n      key: user.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, user.username))))), selectedUser && this.renderForms())));\n  }\n\n  renderForms() {\n    const classes = this.props.classes;\n    const permission = this.state.permission;\n    return React.createElement(React.Fragment, null, React.createElement(Grid, {\n      container: true,\n      spacing: 2,\n      className: classes.mb3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      xs: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(SettingsFormGroup, {\n      label: \"\\u041D\\u0430\\u0441\\u0442\\u0440\\u043E\\u0439\\u043A\\u0438 \\u0441\\u0438\\u0441\\u0442\\u0435\\u043C\\u044B\",\n      values: permission['settings'],\n      handleChange: this.handleChange('settings'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      xs: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(SettingsFormGroup, {\n      label: \"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438\",\n      values: permission['news'],\n      handleChange: this.handleChange('news'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      xs: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(SettingsFormGroup, {\n      label: \"\\u0427\\u0430\\u0442\",\n      values: permission['chat'],\n      handleChange: this.handleChange('chat'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }))), React.createElement(Grid, {\n      container: true,\n      spacing: 2,\n      justify: \"center\",\n      alignItems: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(ButtonGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"contained\",\n      color: \"secondary\",\n      onClick: this.submitHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"), React.createElement(Button, {\n      variant: \"contained\",\n      onClick: this.cancelHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"), React.createElement(Button, {\n      variant: \"contained\",\n      onClick: this.deleteHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  isLoading: isLoadingUsersSelector(state),\n  users: usersSelector(state)\n});\n\nexport default compose(withStyles(styles), connect(mapStateToProps))(AdminPanel);","map":{"version":3,"sources":["/Users/tweecezor/Desktop/nodeJS/src/components/AdminPanel/AdminPanel.jsx"],"names":["React","PureComponent","connect","compose","_cloneDeep","isLoadingUsersSelector","usersSelector","getUsers","updateUserPermission","deleteUser","Container","Avatar","Grid","Paper","Button","ButtonGroup","Select","FormControl","MenuItem","InputLabel","withStyles","SettingsFormGroup","styles","theme","wrapper","width","flex","paddingTop","formCard","padding","spacing","userSelect","userAvatar","marginRight","mb3","marginBottom","defaultState","selectedUserId","selectedUser","permission","chat","C","R","U","D","news","settings","AdminPanel","state","handleChange","part","partRule","event","checked","target","setState","handleChangeUser","users","props","value","find","u","id","submitHandler","dispatch","cancelHandler","deleteHandler","then","componentDidMount","render","classes","image","map","user","username","renderForms","mapStateToProps","isLoading"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport _cloneDeep from 'lodash/cloneDeep';\nimport {\n  isLoadingUsersSelector,\n  usersSelector,\n  getUsers,\n  updateUserPermission,\n  deleteUser\n} from '../../store/adminPanel';\nimport {\n  Container,\n  Avatar,\n  Grid,\n  Paper,\n  Button,\n  ButtonGroup,\n  Select,\n  FormControl,\n  MenuItem,\n  InputLabel\n} from '@material-ui/core';\nimport { withStyles } from '@material-ui/styles';\nimport SettingsFormGroup from './AdminPanelSettingsFormGroup';\n\nconst styles = theme => ({\n  wrapper: {\n    width: '100%',\n    flex: '1 1 100%',\n    paddingTop: '40px'\n  },\n  formCard: {\n    padding: theme.spacing(2)\n  },\n  userSelect: {\n    width: '100%'\n  },\n  userAvatar: {\n    marginRight: theme.spacing(2)\n  },\n  mb3: {\n    marginBottom: theme.spacing(3)\n  }\n});\n\nconst defaultState = {\n  selectedUserId: '',\n  selectedUser: null,\n  permission: {\n    chat: {\n      C: true,\n      R: true,\n      U: false,\n      D: false\n    },\n    news: {\n      C: true,\n      R: true,\n      U: false,\n      D: false\n    },\n    settings: {\n      C: true,\n      R: true,\n      U: false,\n      D: false\n    }\n  }\n};\n\nclass AdminPanel extends PureComponent {\n  state = defaultState;\n\n  componentDidMount() {\n    const { dispatch } = this.props;\n    dispatch(getUsers());\n  }\n\n  handleChange = part => partRule => event => {\n    const { checked } = event.target;\n    const { permission } = this.state;\n    this.setState({\n      permission: {\n        ...permission,\n        [part]: { ...permission[part], [partRule]: checked }\n      }\n    });\n  };\n  handleChangeUser = event => {\n    const { users } = this.props;\n    const { value } = event.target;\n    const selectedUser = value ? _cloneDeep(users.find(u => u.id === value)) : null;\n    this.setState({\n      selectedUserId: value,\n      selectedUser,\n      permission: selectedUser.permission\n    });\n  };\n\n  submitHandler = () => {\n    const { permission, selectedUserId } = this.state;\n    const { dispatch } = this.props;\n    dispatch(updateUserPermission(selectedUserId, permission));\n  };\n\n  cancelHandler = () => {\n    const { users } = this.props;\n    const { selectedUserId } = this.state;\n    const selectedUser = _cloneDeep(users.find(u => u.id === selectedUserId));\n    selectedUserId &&\n      this.setState({\n        selectedUser,\n        permission: selectedUser.permission\n      });\n  };\n\n  deleteHandler = () => {\n    const { selectedUserId } = this.state;\n    const { dispatch } = this.props;\n    selectedUserId && dispatch(deleteUser(selectedUserId)).then(() => this.setState(defaultState));\n  };\n\n  render() {\n    const { classes, users } = this.props;\n    const { selectedUserId, selectedUser } = this.state;\n    return (\n      <div className={classes.wrapper}>\n        <Container>\n          <Paper className={classes.formCard}>\n            <Grid container wrap=\"nowrap\" alignItems=\"center\" className={classes.mb3}>\n              <Avatar\n                src={(selectedUser && selectedUser.image) || '/assets/img/no-user-image.png'}\n                className={classes.userAvatar}\n              ></Avatar>\n              <FormControl className={classes.userSelect}>\n                <InputLabel htmlFor=\"age-simple\">Выберите пользователя</InputLabel>\n                <Select value={selectedUserId} onChange={this.handleChangeUser}>\n                  <MenuItem value={null}>Не выбран</MenuItem>\n                  {users.map(user => (\n                    <MenuItem value={user.id} key={user.id}>\n                      {user.username}\n                    </MenuItem>\n                  ))}\n                </Select>\n              </FormControl>\n            </Grid>\n            {selectedUser && this.renderForms()}\n          </Paper>\n        </Container>\n      </div>\n    );\n  }\n  renderForms() {\n    const { classes } = this.props;\n    const { permission } = this.state;\n    return (\n      <>\n        <Grid container spacing={2} className={classes.mb3}>\n          <Grid item xs={4}>\n            <SettingsFormGroup\n              label=\"Настройки системы\"\n              values={permission['settings']}\n              handleChange={this.handleChange('settings')}\n            />\n          </Grid>\n          <Grid item xs={4}>\n            <SettingsFormGroup\n              label=\"Новости\"\n              values={permission['news']}\n              handleChange={this.handleChange('news')}\n            />\n          </Grid>\n          <Grid item xs={4}>\n            <SettingsFormGroup\n              label=\"Чат\"\n              values={permission['chat']}\n              handleChange={this.handleChange('chat')}\n            />\n          </Grid>\n        </Grid>\n        <Grid container spacing={2} justify=\"center\" alignItems=\"center\">\n          <ButtonGroup>\n            <Button variant=\"contained\" color=\"secondary\" onClick={this.submitHandler}>\n              Сохранить\n            </Button>\n            <Button variant=\"contained\" onClick={this.cancelHandler}>\n              Отменить\n            </Button>\n            <Button variant=\"contained\" onClick={this.deleteHandler}>\n              Удалить пользователя\n            </Button>\n          </ButtonGroup>\n        </Grid>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  isLoading: isLoadingUsersSelector(state),\n  users: usersSelector(state)\n});\n\nexport default compose(\n  withStyles(styles),\n  connect(mapStateToProps)\n)(AdminPanel);\n"]},"metadata":{},"sourceType":"module"}